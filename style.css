:root {
    --primary: #22c55e;
    --grad: linear-gradient(135deg, #22c55e 0%, #15803d 100%);
    --danger: #ff4757;
    --bg: #f2f2f7;
    --text: #000000;
    --card: #ffffff;
    --border: #c6c6c8;
    --nav-bg: rgba(255, 255, 255, 0.85);
    --switch-off: #e9e9ea;
    --icon-inactive: #999999;
    --water-color: #38bdf8;
    --water-dark: #0ea5e9;
    --water-grad: linear-gradient(to top, #0284c7, #38bdf8);
}

body.dark-mode {
    --primary: #4ade80;
    --grad: linear-gradient(135deg, #4ade80 0%, #166534 100%);
    --bg: #000000;
    --text: #ffffff;
    --card: #1c1c1e;
    --border: #38383a;
    --nav-bg: rgba(30, 30, 30, 0.85);
    --switch-off: #39393d;
    --icon-inactive: #666666;
    --water-color: #0ea5e9; 
    --water-dark: #0369a1;
    --water-grad: linear-gradient(to top, #0c4a6e, #0ea5e9);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg); color: var(--text);
    margin: 0; padding: 0; height: 100vh;
    display: flex; flex-direction: column; transition: 0.3s;
    overscroll-behavior: none; overflow: hidden;
}

#loader {
    position: fixed; inset: 0; background: var(--bg); z-index: 9999;
    display: flex; justify-content: center; align-items: center; flex-direction: column;
}

.page { display: none !important; flex: 1; flex-direction: column; padding: 20px; overflow-y: auto; padding-bottom: 100px; align-items: center; -webkit-overflow-scrolling: touch; }
.page.active { display: flex !important; }
#page-view { justify-content: space-between; padding-bottom: 110px; }

.card { background: var(--card); border-radius: 20px; padding: 20px; width: 100%; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.02); text-align: center; transition: transform 0.2s; }
.card:active { transform: scale(0.99); }
.card.locked { opacity: 0.6; background: rgba(128,128,128,0.1); cursor: not-allowed; display: flex; justify-content: space-between; align-items: center; }

.btn { background: var(--grad); color: white; border: none; padding: 15px; width: 100%; border-radius: 15px; font-weight: 600; font-size: 16px; margin-top: 10px; cursor: pointer; box-shadow: 0 4px 10px rgba(34, 197, 94, 0.3); }
.btn.danger { background: var(--danger); box-shadow: 0 4px 10px rgba(255, 71, 87, 0.3); }
.btn.secondary { background: transparent; border: 1px solid var(--border); color: var(--text); box-shadow: none; }

input { width: 100%; padding: 15px; background: var(--card); border: none; border-radius: 15px; color: var(--text); margin-bottom: 12px; outline: none; text-align: center; }

.settings-group { width: 100%; background: var(--card); border-radius: 12px; overflow: hidden; margin-top: 10px; }
.switch-row { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; background: var(--card); transition: 0.2s; position: relative; }
.switch-row:not(:last-child)::after { content: ''; position: absolute; bottom: 0; right: 0; width: calc(100% - 20px); height: 1px; background-color: var(--border); opacity: 0.5; }
.switch { position: relative; display: inline-block; width: 51px; height: 31px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--switch-off); transition: .4s; border-radius: 34px; }
.slider:before { position: absolute; content: ""; height: 27px; width: 27px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 3px 8px rgba(0,0,0,0.15); }
input:checked + .slider { background-color: var(--primary); }
input:checked + .slider:before { transform: translateX(20px); }

.profile-stats-row { display: flex; gap: 15px; width: 100%; margin-bottom: 20px; }
.p-stat-box { flex: 1; background: var(--card); padding: 15px; border-radius: 15px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.03); display: flex; flex-direction: column; justify-content: center; }
.p-val { font-size: 20px; font-weight: 800; color: var(--primary); margin-bottom: 5px; }
.p-lbl { font-size: 12px; opacity: 0.6; }

.circle-wrapper {
    position: relative; width: 280px; height: 280px; min-width: 280px; min-height: 280px;
    border-radius: 50%; background: var(--card);
    box-shadow: inset 10px 10px 20px rgba(0,0,0,0.1), inset -5px -5px 15px rgba(255,255,255,0.5), 0 15px 35px rgba(0,0,0,0.15), 0 0 0 4px var(--card);
    border: 1px solid var(--border); overflow: hidden; cursor: pointer; margin-top: auto; margin-bottom: 40px; z-index: 1;
}
.main-word-display { font-size: 32px; font-weight: 800; text-align: center; color: var(--text); margin: 20px 0; line-height: 1.2; word-wrap: break-word; padding: 0 20px; }
.liquid-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 0%; transition: height 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); z-index: 2; }
.liquid-body { width: 100%; height: 100%; background: var(--water-grad); }
.wave { position: absolute; top: -15px; left: 0; width: 200%; height: 30px; background-repeat: repeat-x; background-size: 50% 100%; border-radius: 1000% 1000% 0 0; opacity: 1; }
.wave-front { background-color: var(--water-color); animation: waveMove 4s linear infinite; z-index: 3; opacity: 0.8; }
.wave-back { background-color: var(--water-dark); top: -20px; animation: waveMove 7s linear infinite reverse; z-index: 2; opacity: 0.5; }
@keyframes waveMove { 0% { transform: translateX(0) scaleY(1); } 50% { transform: translateX(-25%) scaleY(0.8); } 100% { transform: translateX(-50%) scaleY(1); } }
.droplet { position: absolute; top: -20px; left: 50%; width: 14px; height: 14px; background: var(--water-color); border-radius: 0 50% 50% 50%; transform: translateX(-50%) rotate(45deg); z-index: 5; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
.splash-particle { position: absolute; width: 6px; height: 6px; background: var(--water-color); border-radius: 50%; z-index: 6; pointer-events: none; }
.ripple { position: absolute; left: 50%; width: 10px; height: 4px; border: 2px solid rgba(255,255,255,0.8); border-radius: 50%; transform: translate(-50%, -50%) scale(0); z-index: 4; animation: rippleAnim 0.6s ease-out forwards; }
@keyframes rippleAnim { to { transform: translate(-50%, -50%) scale(8); opacity: 0; border-width: 0; } }
.glass-shine { position: absolute; top: 10%; left: 10%; width: 40%; height: 20%; background: linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 70%); border-radius: 50%; transform: rotate(-45deg); z-index: 10; pointer-events: none; filter: blur(2px); }

.nav { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; height: 70px; background: var(--nav-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-radius: 25px; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.1); z-index: 100; }
.nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 60px; height: 100%; cursor: pointer; color: var(--icon-inactive); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
.nav-item svg { width: 28px; height: 28px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; transition: 0.3s; }
.nav-item.active { color: var(--primary); }
.nav-item.active svg { transform: translateY(-5px); filter: drop-shadow(0 5px 10px rgba(34, 197, 94, 0.4)); }
.nav-dot { width: 5px; height: 5px; background: var(--primary); border-radius: 50%; margin-top: 5px; opacity: 0; transform: scale(0); transition: 0.3s; }
.nav-item.active .nav-dot { opacity: 1; transform: scale(1); }
.header-nav { width: 100%; display: flex; align-items: center; margin-bottom: 10px; flex-shrink: 0; }
.back-btn { font-size: 24px; padding-right: 15px; cursor: pointer; }
